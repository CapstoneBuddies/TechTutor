RewriteEngine On

#RewriteBase /

# Remove trailing slashes except for root "/"
RewriteCond %{REQUEST_URI} ^(.+)/$ [NC]
RewriteRule ^(.+)/$ %1 [R=301,L]

#Route to homepage
RewriteRule ^(.*)/?home$ backends/route.php [L]

#Route /login to pages/login.php
RewriteRule ^login$ pages/login.php [L]

#Route /register to pages/signup.php
RewriteRule ^register$ pages/signup.php [L]

#Route /verify to pages/verify.php
RewriteRule ^verify$ pages/verify.php [L]

#Route /forgot-password to pages/forgot_password.php
RewriteRule ^forgot_password$ pages/forgot_password.php [L]

#Route logics to route.php
RewriteRule ^(.*)/?user-login$ backends/route.php [L]
RewriteRule ^(.*)/?user-register$ backends/route.php [L]
RewriteRule ^(.*)/?user-logout$ backends/route.php [L]
RewriteRule ^(.*)/?verify_code$ backends/route.php [L]
RewriteRule ^(.*)/?resend-verification-code$ backends/route.php [L]
RewriteRule ^(.*)/?user-profile-update$ backends/route.php [L,QSA]
RewriteRule ^(.*)/?user-deactivate$ backends/route.php [L]
RewriteRule ^(.*)/?user-change-password$ backends/route.php [L]
RewriteRule ^(.*)/?admin-delete-user$ backends/route.php [L]
RewriteRule ^(.*)/?admin-restrict-user$ backends/route.php [L]
RewriteRule ^(.*)/?admin-activate-user$ backends/route.php [L]



#Profile And its subheader handler
RewriteRule ^dashboard/profile$ pages/profile.php [L]
RewriteRule ^dashboard/settings$ pages/settings.php [L]


# Redirect user to student pages if role=TechKids
RewriteCond %{HTTP_COOKIE} role=TECHKID(;|$)
RewriteRule ^dashboard$ pages/techkid/main_dashboard.php [L]

# Redirect user to tutor pages if role=TechGuru
RewriteCond %{HTTP_COOKIE} role=TECHGURU(;|$)
RewriteRule ^dashboard$ pages/techguru/main_dashboard.php [L]

# Redirect user to admin pages if role=Admin
RewriteCond %{HTTP_COOKIE} role=ADMIN(;|$)
RewriteRule ^dashboard$ pages/admin/main_dashboard.php [L]
RewriteRule ^dashboard/TechKids$ pages/admin/main_view-techkids.php [L]
RewriteRule ^dashboard/TechGurus$ pages/admin/main_view-techguru.php [L]
RewriteRule ^dashboard/users$ pages/admin/main_view-users.php [L]
RewriteRule ^dashboard/transactions$ pages/admin/main_view-transactions.php [L]
RewriteRule ^dashboard/notifications$ pages/admin/main_view-notifications.php [L]
RewriteRule ^dashboard/courses$ pages/admin/main_view-course.php [L]