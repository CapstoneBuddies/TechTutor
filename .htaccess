ErrorDocument 404 /capstone-1/pages/error/404.php
ErrorDocument 403 /capstone-1/pages/error/403.php
ErrorDocument 500 /capstone-1/pages/error/500.php

RewriteEngine On

# üîπ Remove trailing slashes except for root "/"
RewriteCond %{REQUEST_URI} ^(.+)/$ [NC]
RewriteRule ^(.+)/$ %1 [R=301,L]

# ----------------------------------
# üåê General Page Routing
# ----------------------------------
RewriteRule ^home$ backends/route.php [L]
RewriteRule ^login$ pages/login.php [L]
RewriteRule ^register$ pages/signup.php [L]
RewriteRule ^verify$ pages/verify.php [L]
RewriteRule ^forgot$ pages/forgot-password.php [L]
RewriteRule ^reset-password$ pages/reset-password.php [L,QSA]
RewriteRule ^dashboard/[sta]/profile$ pages/profile.php [L]
RewriteRule ^dashboard/[sta]/settings$ pages/settings.php [L]
RewriteRule ^dashboard/[sta]/transactions$ pages/transactions.php [L]
RewriteRule ^dashboard/[sta]/notifications$ pages/notifications.php [L]

# ----------------------------------
# üîπ Authentication and User Actions
# ----------------------------------
RewriteRule ^user-login$ backends/route.php [L]
RewriteRule ^user-register$ backends/route.php [L]
RewriteRule ^user-logout$ backends/route.php [L]
RewriteRule ^verify_code$ backends/route.php [L]
RewriteRule ^forgot-password$ backends/route.php [L]
RewriteRule ^resend-verification-code$ backends/route.php [L]
RewriteRule ^(.*)/?user-profile-update$ backends/route.php [L,QSA]
RewriteRule ^(.*)/?user-deactivate$ backends/route.php [L]
RewriteRule ^(.*)/?user-change-password$ backends/route.php [L]

# ----------------------------------
# üõë Admin-Specific Actions
# ----------------------------------
RewriteRule ^a/delete-user$ backends/route.php [L]
RewriteRule ^a/restrict-user$ backends/route.php [L]
RewriteRule ^a/activate-user$ backends/route.php [L]

# ----------------------------------
# üí∞ Payment Routes
# ----------------------------------
RewriteRule ^(.*)/?payment$ pages/payment.php [L]
RewriteRule ^(.*)/?payment-success$ pages/payment-success.php [L]
RewriteRule ^(.*)/?payment-failed$ pages/payment-failed.php [L]
RewriteRule ^(.*)/?create-payment$ backends/route.php [L]
RewriteRule ^(.*)/?process-card-payment$ backends/route.php [L]

# ----------------------------------
# üîî Notifications & Transactions
# ----------------------------------
RewriteRule ^mark-notification-read$ backends/route.php [L]
RewriteRule ^get-transactions$ backends/route.php [L]
RewriteRule ^get-transaction-details$ backends/route.php [L]
RewriteRule ^export-transactions$ backends/route.php [L]

# ----------------------------------
# üè† Dashboard Routing by Role
# ----------------------------------
RewriteRule ^dashboard$ backends/role_redirect.php [L]
RewriteRule ^dashboard/s$ backends/role_redirect.php [L]
RewriteRule ^dashboard/t$ backends/role_redirect.php [L]
RewriteRule ^dashboard/a$ backends/role_redirect.php [L]

# ----------------------------------
# üë®‚Äçüéì TechKids (Students) Routes
# ----------------------------------
RewriteRule ^dashboard/s/class$ pages/techkid/class.php [L]
RewriteRule ^dashboard/s/schedule$ pages/techkid/schedule.php [L]
RewriteRule ^dashboard/s/files$ pages/techkid/files.php [L]
RewriteRule ^dashboard/s/certificates$ pages/techkid/certificate.php [L]

# ----------------------------------
# üë®‚Äçüè´ TechGuru (Tutors) Routes
# ----------------------------------
RewriteRule ^dashboard/t/class$ pages/techguru/classes.php [L]
RewriteRule ^dashboard/t/certificates$ pages/default.php [L]
RewriteRule ^dashboard/t/subjects$ pages/techguru/subjects.php [L]
RewriteRule ^dashboard/t/subjects/class$ pages/techguru/subject-details.php [L,QSA]
RewriteRule ^dashboard/t/class/details$ pages/techguru/class-details.php [L,QSA]
RewriteRule ^dashboard/t/class/edit$ pages/techguru/class-edit.php [L,QSA]

# ----------------------------------
# üîß Admin Routes
# ----------------------------------
RewriteRule ^dashboard/a/users$ pages/admin/view-users.php [L]
RewriteRule ^dashboard/a/courses$ pages/admin/view-course.php [L]
RewriteRule ^dashboard/a/classes$ pages/admin/view-class.php [L]
RewriteRule ^dashboard/a/class-details$ pages/admin/class-details.php [L,QSA]

# ----------------------------------
# üõ† Admin AJAX Actions
# ----------------------------------
RewriteRule ^dashboard/admin/get-users$ backends/admin/get_users.php [L]
RewriteRule ^dashboard/admin/toggle-user-status$ backends/admin/toggle_user_status.php [L]
RewriteRule ^dashboard/admin/delete-users$ backends/admin/delete_user.php [L]
RewriteRule ^dashboard/admin/send-password-reset$ backends/admin/send_password_reset.php [L]
RewriteRule ^dashboard/admin/get-user-emails$ backends/admin/get_user_emails.php [L]
RewriteRule ^dashboard/admin/toggle-subject-status$ backends/admin/course_handler.php [L,QSA]
RewriteRule ^dashboard/admin/add-course$ backends/admin/course_handler.php [L]
RewriteRule ^dashboard/admin/edit-course$ backends/admin/course_handler.php [L]
RewriteRule ^dashboard/admin/delete-course$ backends/admin/course_handler.php [L]

# ----------------------------------
# üåç API Endpoints
# ----------------------------------
RewriteRule ^api/toggle-class-status$ api/toggle-class-status.php [L]