	RewriteEngine On

# Remove trailing slashes except for root "/"
RewriteCond %{REQUEST_URI} ^(.+)/$ [NC]
RewriteRule ^(.+)/$ %1 [R=301,L]

#Common pages routing
RewriteRule ^(.*)/?home$ backends/route.php [L]
RewriteRule ^login$ pages/login.php [L]
RewriteRule ^register$ pages/signup.php [L]
RewriteRule ^verify$ pages/verify.php [L]
RewriteRule ^forgot$ pages/forgot-password.php [L]
RewriteRule ^reset-password$ pages/reset-password.php [L,QSA]

#Route logics to route.php
RewriteRule ^(.*)/?user-login$ backends/route.php [L]
RewriteRule ^(.*)/?user-register$ backends/route.php [L]
RewriteRule ^(.*)/?user-logout$ backends/route.php [L]
RewriteRule ^(.*)/?verify_code$ backends/route.php [L]
RewriteRule ^(.*)/?forgot-password$ backends/route.php [L]
RewriteRule ^(.*)/?resend-verification-code$ backends/route.php [L]
RewriteRule ^(.*)/?user-profile-update$ backends/route.php [L,QSA]
RewriteRule ^(.*)/?user-deactivate$ backends/route.php [L]
RewriteRule ^(.*)/?user-change-password$ backends/route.php [L]
RewriteRule ^(.*)/?admin-delete-user$ backends/route.php [L]
RewriteRule ^(.*)/?admin-restrict-user$ backends/route.php [L]
RewriteRule ^(.*)/?admin-activate-user$ backends/route.php [L]
RewriteRule ^(.*)/?get-transactions$ backends/route.php [L]
RewriteRule ^(.*)/?get-transaction-details$ backends/route.php [L]
RewriteRule ^(.*)/?export-transactions$ backends/route.php [L]
RewriteRule ^(.*)/?create-payment$ backends/route.php [L]
RewriteRule ^(.*)/?process-card-payment$ backends/route.php [L]
RewriteRule ^(.*)/?mark-notification-read$ backends/route.php [L]

# Payment routes
RewriteRule ^(.*)/?payment$ pages/payment.php [L]
RewriteRule ^(.*)/?payment-success$ pages/payment-success.php [L]
RewriteRule ^(.*)/?payment-failed$ pages/payment-failed.php [L]

#Profile and user default redirect
RewriteRule ^dashboard/profile$ pages/profile.php [L]
RewriteRule ^dashboard/settings$ pages/settings.php [L]
RewriteRule ^dashboard/notifications$ pages/notifications.php [L]
RewriteRule ^dashboard/transactions$ pages/transactions.php [L]

# Redirect user to student pages if role=TechKids
RewriteCond %{HTTP_COOKIE} role=TECHKID(;|$)
RewriteRule ^(.*)/?dashboard$ pages/techkid/main_dashboard.php [L]

# Redirect user to tutor pages if role=TechGuru
RewriteCond %{HTTP_COOKIE} role=TECHGURU(;|$)
RewriteRule ^dashboard$ pages/techguru/main_dashboard.php [L]
RewriteRule ^dashboard/class$ pages/techguru/classes.php [L]
RewriteRule ^dashboard/subjects$ pages/techguru/subjects.php [L]
RewriteRule ^dashboard/subjects/class$ pages/techguru/subject-details.php [L,QSA]
RewriteRule ^dashboard/subjects/class/create$ pages/techguru/create-class.php [L]
RewriteRule ^dashboard/class/details$ pages/techguru/class-details.php [L,QSA]
RewriteRule ^dashboard/class/edit$ pages/techguru/class-edit.php [L,QSA]

# Redirect user to admin pages if role=Admin
RewriteCond %{HTTP_COOKIE} role=ADMIN(;|$)
RewriteRule ^dashboard$ pages/admin/main_dashboard.php [L]
RewriteRule ^dashboard/users$ pages/admin/view-users.php [L]
RewriteRule ^dashboard/courses$ pages/admin/view-course.php [L]
RewriteRule ^dashboard/classes$ pages/admin/view-class.php [L]
RewriteRule ^dashboard/classes/details$ pages/admin/class-details.php [L,QSA]

#Admin AJAX REDIRECT
RewriteRule ^dashboard/get-users$ backends/admin/get_users.php [L]
RewriteRule ^dashboard/toggle-user-status$ backends/admin/toggle_user_status.php [L]
RewriteRule ^dashboard/delete-users$ backends/admin/delete_user.php [L]
RewriteRule ^dashboard/send-password-reset$ backends/admin/send_password_reset.php [L]
RewriteRule ^dashboard/get-user-emails$ backends/admin/get_user_emails.php [L]
RewriteRule ^mark-all-notifications-read$ backends/mark_all_notifications_read.php [L]
RewriteRule ^dashboard/toggle-subject-status$ backends/admin/course_handler.php [L,QSA]
RewriteRule ^dashboard/add-course$ backends/admin/course_handler.php [L]
RewriteRule ^dashboard/add-subject$ backends/admin/course_handler.php [L]
RewriteRule ^dashboard/edit-course$ backends/admin/course_handler.php [L]
RewriteRule ^dashboard/delete-course$ backends/admin/course_handler.php [L]

#API REDIRECT
RewriteRule ^api/toggle-class-status$ api/toggle-class-status.php [L]